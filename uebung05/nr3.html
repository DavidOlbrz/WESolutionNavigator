<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>5.3 TopSort als Web-App</title>
    <script>
        let inputArray = [];

        function compare(a, b) {
            if (a[0] === b[1]) {
                return 1;
            } else if (a[1] === b[0]) {
                return -1;
            } else {
                return 0;
            }
        }

        function topSort(input) {
            let array = input;
            array.sort(compare);
            const sorted = new Set;
            for (let x in array) {
                sorted.add(array[x][0]);
                if (x == array.length - 1) {
                    sorted.add(array[x][1]);
                }
            }
            return sorted;
        }

        function testTopSort() {
            const array = [["schlafen", "studieren"], ["essen", "studieren"], ["studieren", "prüfen"]];
            const sorted = topSort(array);
            console.assert(Array.from(sorted).toString() === "schlafen,essen,studieren,prüfen");
        }

        function addTask(a, b) {
            inputArray.push([a, b]);
            let item = document.createElement('li');
            item.innerHTML = a + ", " + b;
            document.getElementById('inputs').appendChild(item);
            document.getElementById('input-a').value = "";
            document.getElementById('input-b').value = "";
        }

        function generateResults() {
            document.querySelector('#sorted-result').innerHTML = '';
            if (inputArray.length === 0) {
                const item = document.createElement("li");
                item.innerHTML = "Sie haben noch keine Eingaben gemacht!"
                document.getElementById('sorted-result').appendChild(item);
            } else {
                const result = Array.from(topSort(inputArray));
                console.log(result);
                for (let x in result) {
                    const item = document.createElement("li");
                    item.innerHTML = result[x];
                    console.log(x + ': Task ' + result[x]);
                    document.getElementById('sorted-result').appendChild(item);
                }
            }
        }
    </script>
</head>
<body>
<h1>TopSort</h1>
<form method="dialog"
      onsubmit="addTask(document.getElementById('input-a').value, document.getElementById('input-b').value)">
    <label>
        Voraussetzung
        <input id="input-a" type="text" required>
    </label>
    <label>
        Aufgabe
        <input id="input-b" type="text" required>
    </label>
    <input type="submit" value="Fertig">
</form>
<hr>
<h2>Eingaben</h2>
<ul id="inputs">
    <!-- Inputs will appear in the list -->
</ul>
<hr>
<h2>Ergebnis</h2>
<button onclick="generateResults()">Ergebnis anzeigen</button>
<ol id="sorted-result">
    <!-- result will appear here -->
</ol>
</body>
</html>