<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Übung 12 | Solution-Navigator</title>
    <link href="/assets/favicon.ico" rel="icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css"
          integrity="sha512-P9vJUXK+LyvAzj8otTOKzdfF1F3UYVl13+F8Fof8/2QNb8Twd6Vb+VD52I7+87tex9UXxnzPgWA3rH96RExA7A=="
          crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css"
          integrity="sha512-tk4nGrLxft4l30r9ETuejLU0a3d7LwMzj0eXjzc16JQj+5U1IeVoCuGLObRDc3+eQMUcEQY1RIDPGvuA7SNQ2w=="
          crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <script src="https://kit.fontawesome.com/37beb9f2cd.js" crossorigin="anonymous"></script>
    <link href="../css/uebung.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="/scripts/toggleCode.js"></script>
</head>
<body>
<header id="top">
    <script src="/scripts/header.js"></script>
    <a id="logo" href="..">
        <svg height="2.5rem" width="3.5rem">
            <rect x="0" y="0" height="100%" width="100%" fill="none" stroke="white" stroke-width="5"></rect>
            <text x="50%" y="50%" text-anchor="middle" dominant-baseline="central" font-size="2rem" fill="white">
                SN
            </text>
        </svg>
        <span id="logo-text">Solution Navigator</span>
    </a>
    <nav id="header-nav">
        <i id="menu-button" class="fa-solid fa-bars" onclick="openMenu()"></i>
        <div id="menu-container">
            <ul>
                <li>
                    <a href="..">Übersicht</a>
                </li>
                <li class="current">
                    <script src="/scripts/taskjumper.js"></script>
                    <label id="task-select">
                        <select onchange="jumpToTask(this.value)">
                            <option value="0">Zu Übung springen</option>
                            <option value="1">Übung 01</option>
                            <option value="2">Übung 02</option>
                            <option value="3">Übung 03</option>
                            <option value="4">Übung 04</option>
                            <option value="5">Übung 05</option>
                            <option value="6">Übung 06</option>
                            <option value="7">Übung 07</option>
                            <option value="8">Übung 08</option>
                            <option value="9">Übung 09</option>
                            <option value="10">Übung 10</option>
                            <option value="11">Übung 11</option>
                            <option value="12" selected>Übung 12</option>
                        </select>
                    </label>
                </li>
                <li>
                    <a href="../about.html">Über mich</a>
                </li>
                <li>
                    <a href="../credits.html">Credits</a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<h1>Übung 12: Server-side Scripting (PHP)</h1>

<div class="aufgaben_nav container">
    <h2>Aufgaben</h2>
    <nav><a href="#task1">12.1 Registrierung mit PHP</a></nav>
</div>

<h2 id="task1">12.1 Registrierung mit PHP</h2>

<div class="container">
    <p style="margin-top: 0">Erstellen Sie mit PHP ein Registrierungsformular. Speichern Sie die eingegebenen Daten
        persistent in einer Datei. Schreiben Sie Ihre PHP-Scripte so, dass es dabei zu keinen <a
                href="https://de.wikipedia.org/wiki/Wettlaufsituation" target="_blank">Nebenläufigkeitsartefakten</a>
        (z.B. <a href="https://de.wikipedia.org/wiki/Verlorenes_Update" target="_blank">Lost Update</a>) kommen kann,
        egal wie viele Nutzer sich gleichzeitig registrieren.</p>
    <p><strong>Hinweis:</strong> In der Demo keine echten Zugangsdaten eingeben, das System ist nicht verschlüsselt!</p>
    <p><em>Hinweis 2:</em> Die Ausführung von PHP-Code funktioniert nicht über den WebStorm Live Server! Es wird ein
        vollwertiger Server mit PHP-Unterstützung benötigt (z.B. <a href="https://www.apachefriends.org/index.html"
                                                                    target="_blank">XAMPP</a>)</p>
    <br>
    <iframe src="nr1.html" width="500" height="300"></iframe>
    <br><br>
    <script src="scripts/showFile.js"></script>
    <button onclick="showLastLine()"><i class="fa-solid fa-user"></i> Letzten Account anzeigen</button>
    <br><br>
    <button onclick="showFileContent()"><i class="fa-solid fa-list"></i> Alle Accounts anzeigen</button>
    (Output in der Konsole)
    <br>
    <p style="text-decoration-line: underline">HTML</p>
    <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="de"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Registrierung&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Neuen Account erstellen&lt;/h1&gt;
&lt;form method="post" action="registration.php"&gt;
    &lt;label&gt;
        Benutzername
        &lt;input type="text" name="username" placeholder="Benutzername" required/&gt;
    &lt;/label&gt;
    &lt;br&gt;&lt;br&gt;
    &lt;label&gt;
        Passwort
        &lt;input type="password" name="password" placeholder="Passwort" required/&gt;
    &lt;/label&gt;
    &lt;br&gt;&lt;br&gt;
    &lt;input type="submit" value="Registrieren"&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
    <p style="text-decoration-line: underline">PHP</p>
    <pre><code>&lt;?php
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $username = $_POST["username"];
    $password = $_POST["password"];

    $file_path = "accounts.txt";

    $file = fopen($file_path, "a");
    if (flock($file, LOCK_EX)) { // lock file
        fwrite($file, "$username | $password\n");

        flock($file, LOCK_UN); // unlock file
        fclose($file);

        header("Location: nr1.html");
        exit();
    } else {
        echo "Fehler beim Sperren der Datei!";
    }
}
?&gt;</code></pre>
</div>

<a id="top_button" href="#top"><i class="fa-solid fa-arrow-up"></i></a>
</body>
</html>