<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Übung 04 | Solution-Navigator</title>
    <link href="/assets/favicon.ico" rel="icon">
    <meta name="viewport" content="width=device-width">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css"
          integrity="sha512-P9vJUXK+LyvAzj8otTOKzdfF1F3UYVl13+F8Fof8/2QNb8Twd6Vb+VD52I7+87tex9UXxnzPgWA3rH96RExA7A=="
          crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css"
          integrity="sha512-tk4nGrLxft4l30r9ETuejLU0a3d7LwMzj0eXjzc16JQj+5U1IeVoCuGLObRDc3+eQMUcEQY1RIDPGvuA7SNQ2w=="
          crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <script src="https://kit.fontawesome.com/37beb9f2cd.js" crossorigin="anonymous"></script>

    <link href="../css/uebung.css" rel="stylesheet">

    <!-- highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <script src="/scripts/toggleCode.js"></script>
    <script>
        // task 1

        function identity(arg) {
            return arg;
        }

        function identity_function(arg) {
            return identity(arg);
        }

        function add(opA, opB) {
            return opA + opB;
        }

        function mul(opA, opB) {
            return opA * opB;
        }

        function addf(x) {
            return function (y) {
                return x + y;
            }
        }

        function applyf(func) {
            return function (x) {
                return function (y) {
                    return func(x, y);
                }
            }
        }

        // task 2

        function Person(name) {
            this.name = name;
            this.cars = []
        }

        function Car(brand, owner) {
            this.brand = brand;
            this.owner = owner;
        }

        Person.prototype.addCar = function (car) {
            this.cars.push(car);
        };

        Car.prototype.conflict = function () {
            const owners = this.owner ? [this.owner] : [];
            for (let i = 0; i < this.owner.cars.length; i++) {
                if (this.owner.cars[i] !== this && this.owner.cars[i].brand === this.brand) {
                    return true;
                }
            }
            return false;
        };

        // task 3

        function fibonacci(n) {
            if (n === 0) {
                return [];
            } else if (n === 1) {
                return [0n];
            } else {
                let fib = [0n, 1n];
                for (let i = 2; i < n; i++) {
                    fib.push(fib[i - 1] + fib[i - 2]);
                }
                return fib;
            }
        }

        function runFibonacci() {
            console.log(fibonacci(2000));
        }

        // task 4

        function compare(a, b) {
            if (a[0] === b[1]) {
                return 1;
            } else if (a[1] === b[0]) {
                return -1;
            } else {
                return 0;
            }
        }

        function topSort(input) {
            let array = input;
            array.sort(compare);
            const sorted = new Set;
            for (let x in array) {
                sorted.add(array[x][0]);
                if (x == array.length - 1) {
                    sorted.add(array[x][1]);
                }
            }
            return sorted;
        }

        function testTopSort() {
            const array = [["schlafen", "studieren"], ["essen", "studieren"], ["studieren", "prüfen"]];
            console.log(`Input:`);
            console.log(array);
            const sorted = topSort(array);
            console.log(`Output:`);
            console.log(sorted);
            console.assert(Array.from(sorted).toString() === "schlafen,essen,studieren,prüfen");
        }
    </script>
</head>
<body>
<header id="top">
    <script src="/scripts/header.js"></script>
    <a id="logo" href="..">
        <svg height="2.5rem" width="3.5rem">
            <rect x="0" y="0" height="100%" width="100%" fill="none" stroke="white" stroke-width="5"></rect>
            <text x="50%" y="50%" text-anchor="middle" dominant-baseline="central" font-size="2rem" fill="white">
                SN
            </text>
        </svg>
        <span id="logo-text">Solution Navigator</span>
    </a>
    <nav id="header-nav">
        <i id="menu-button" class="fa-solid fa-bars" onclick="openMenu()"></i>
        <div id="menu-container">
            <ul>
                <li>
                    <a href="..">Übersicht</a>
                </li>
                <li class="current">
                    <script src="/scripts/taskjumper.js"></script>
                    <label id="task-select">
                        <select onchange="jumpToTask(this.value)">
                            <option value="0">Zu Übung springen</option>
                            <option value="1">Übung 01</option>
                            <option value="2">Übung 02</option>
                            <option value="3">Übung 03</option>
                            <option value="4" selected>Übung 04</option>
                            <option value="5">Übung 05</option>
                            <option value="6">Übung 06</option>
                            <option value="7">Übung 07</option>
                            <option value="8">Übung 08</option>
                            <option value="9">Übung 09</option>
                            <option value="10">Übung 10</option>
                            <option value="11">Übung 11</option>
                            <option value="12">Übung 12</option>
                        </select>
                    </label>
                </li>
                <li>
                    <a href="../about.html">Über mich</a>
                </li>
                <li>
                    <a href="../credits.html">Credits</a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<h1>Übung 4: JavaScript (JS)</h1>

<div class="aufgaben_nav container">
    <h2>Aufgaben</h2>
    <nav><a href="#task1">4.1 Funktionen</a></nav>
    <nav><a href="#task2">4.2 Objekte</a></nav>
    <nav><a href="#task3">4.3 Fibonacci</a></nav>
    <nav><a href="#task4">4.4 TopSort</a></nav>
</div>

<h2 id="task1">4.1 Funktionen</h2>

<div class="container">
    <h4>1. Eine Funktion <code>identity()</code>, die ein Argument als Parameter
        entgegennimmt und dieses als Ergebnis
        zurückgibt.</h4>
    <br>
    <label for="input_1_1">Input</label>
    <input id="input_1_1" type="text">
    <button onclick="document.getElementById('result_1_1').value = identity(document.getElementById('input_1_1').value)">
        <i class="fa-solid fa-play"></i> Ausführen
    </button>
    <br><br>
    <label for="result_1_1">Output</label>
    <input id="result_1_1" type="text" placeholder="Ergebnis erscheint hier" disabled>
    <p style="text-decoration-line: underline">Source Code</p>
    <pre style="margin-bottom: 0"><code>function identity(arg) {
    return arg;
}</code></pre>
</div>
<div class="container">
    <h4>2. Eine Funktion <code>identity_function()</code>, die ein Argument als Parameter entgegennimmt und eine
        Funktion
        zurückgibt, die
        dieses Argument zurückgibt.</h4>
    <br>
    <label for="input_1_2">Input</label>
    <input id="input_1_2" type="text">
    <button onclick="document.getElementById('result_1_2').value = identity_function(document.getElementById('input_1_2').value)">
        <i class="fa-solid fa-play"></i> Ausführen
    </button>
    <br><br>
    <label for="result_1_2">Output</label>
    <input id="result_1_2" type="text" placeholder="Ergebnis erscheint hier" disabled>
    <p style="text-decoration-line: underline">Source Code</p>
    <pre style="margin-bottom: 0"><code>function identity_function(arg) {
    return identity(arg);
}</code></pre>
</div>
<div class="container">
    <h4>3. Zwei binäre Funktionen <code>add</code> und <code>mul</code>, die Summe und Produkt berechnen.</h4>
    <br>
    <label for="input_1_3a">Operand A</label>
    <input id="input_1_3a" type="number">
    <label for="input_1_3b">Operand B</label>
    <input id="input_1_3b" type="number">
    <button onclick="document.getElementById('result_1_3add').value = add(parseInt(document.getElementById('input_1_3a').value), parseInt(document.getElementById('input_1_3b').value));document.getElementById('result_1_3mul').value = mul(parseInt(document.getElementById('input_1_3a').value), parseInt(document.getElementById('input_1_3b').value));">
        <i class="fa-solid fa-play"></i> Ausführen
    </button>
    <br><br>
    <label for="result_1_3add">Output <code>add</code></label>
    <input id="result_1_3add" placeholder="Ergebnis erscheint hier" disabled>
    <label for="result_1_3mul">Output <code>mul</code></label>
    <input id="result_1_3mul" placeholder="Ergebnis erscheint hier" disabled>
    <p style="text-decoration-line: underline">Source Code</p>
    <pre style="margin-bottom: 0"><code>function add(opA, opB) {
    return opA + opB;
}

function mul(opA, opB) {
    return opA * opB;
}</code></pre>
</div>
<div class="container">
    <h4>4. Eine Addierer-Funktion <code>addf()</code>, so dass <code>addf(x)(y)</code> genau <code>x + y</code>
        zurückgibt.
        (Es haben also zwei Funktionsaufrufe zu
        erfolgen. <code>addf(x)</code> liefert eine Funktion, die auf <code>y</code> angewandt wird.)</h4>
    <br>
    <label for="input_1_4a">Operand A</label>
    <input id="input_1_4a" type="number">
    <label for="input_1_4b">Operand B</label>
    <input id="input_1_4b" type="number">
    <button onclick="document.getElementById('result_1_4').value = addf(parseInt(document.getElementById('input_1_4a').value))(parseInt(document.getElementById('input_1_4b').value))">
        <i class="fa-solid fa-play"></i> Ausführen
    </button>
    <br><br>
    <label for="result_1_4">Output</label>
    <input id="result_1_4" placeholder="Ergebnis erscheint hier">
    <p style="text-decoration-line: underline">Source Code</p>
    <pre style="margin-bottom: 0"><code>function addf(x) {
    return function (y) {
        return x + y;
    }
}</code></pre>
</div>
<div class="container">
    <h4>5. Eine Funktion <code>applyf()</code>, die aus einer binären Funktion wie <code>add(x,y)</code> eine Funktion
        <code>addf</code>
        berechnet, die mit zwei
        Aufrufen das gleiche Ergebnis liefert, z.B. <code>addf = applyf(add); addf(x)(y)</code> soll
        <code>add(x,y)</code>
        liefern. Entsprechend
        <code>applyf(mul)(5)(6)</code> soll <code>30</code> liefern, wenn <code>mul</code> die binäre Multiplikation
        ist.
    </h4>
    <br>
    <label for="input_1_5a">Operand A</label>
    <input id="input_1_5a" type="number">
    <label for="input_1_5b">Operand B</label>
    <input id="input_1_5b" type="number">
    <br><br>
    <label for="input_1_5c">Operator</label>
    <select id="input_1_5c">
        <option value="add">add</option>
        <option value="mul">mul</option>
    </select>
    <button onclick="document.getElementById('result_1_5').value = applyf(eval(document.getElementById('input_1_5c').value))(parseInt(document.getElementById('input_1_5a').value))(parseInt(document.getElementById('input_1_5b').value))">
        <i class="fa-solid fa-play"></i> Ausführen
    </button>
    <br><br>
    <label for="result_1_5">Output</label>
    <input id="result_1_5" placeholder="Ergebnis erscheint hier" disabled>
    <p style="text-decoration-line: underline">Source Code</p>
    <pre style="margin-bottom: 0"><code>function applyf(func) {
    return function (x) {
        return function (y) {
            return func(x, y);
        }
    }
}</code></pre>
</div>
<hr>

<h2 id="task2">4.2 Objekte</h2>

<div class="container">
    <h4>Schreiben Sie die Prototypen <code>Person</code> und <code>Auto</code> in JavaScript, sodass jede Person weiß,
        welche
        Autos sie besitzt.
        Schreiben Sie eine Funktion <code>conflict()</code>, die feststellt, ob ein Auto von mehr als einer Person
        besessen
        wird.</h4>
    <pre style="margin-bottom: 0"><code>function Person(name) {
    this.name = name;
    this.cars = []
}

function Car(brand, owner) {
    this.brand = brand;
    this.owner = owner;
}

Person.prototype.addCar = function (car) {
    this.cars.push(car);
};

Car.prototype.conflict = function () {
    const owners = this.owner ? [this.owner] : [];
    for (let i = 0; i < this.owner.cars.length; i++) {
        if (this.owner.cars[i] !== this && this.owner.cars[i].brand === this.brand) {
            return true;
        }
    }
    return false;
};</code></pre>
</div>
<hr>

<h2 id="task3">4.3 Fibonacci</h2>

<div class="container">
    <h4>Schreiben Sie im Browser die <a href="https://de.wikipedia.org/wiki/Fibonacci-Folge">Fibonacci-Funktion</a> in
        JS
        und
        geben Sie die ersten 2000 Fibonacci-Zahlen
        0,1,1,2,3,5,8,13,... auf der Konsole mit <code>console.log()</code> aus.</h4>
    <p>Achten Sie auf Performanz: Berechnen Sie jeden Fibonacci-Wert nur einmal. Speichern Sie zu diesem Zweck jede
        berechnete Fibonacci-Zahl in einer Tabelle.</p>
    <ol>
        <li>Was ist die größte Fibonacci-Zahl, die sich noch als <code>Integer</code> sicher speichern lässt (<a
                href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER">Number.MAX_SAFE_INTEGER</a>)?
            Die wievielte Zahl in der Fibonacci-Folge ist das?
        </li>
        <li>Was ist die größte Fibonacci-Zahl, die sich noch als <code>Number</code> speichern lässt (<a
                href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_VALUE">Number.MAX_VALUE</a>)?
            Die wievielte Zahl in der Fibonacci-Folge ist das?
        </li>
        <li>Wechseln Sie zu <code>BigInt</code>, um alle 2000 Fibonacci-Zahlen korrekt anzuzeigen.</li>
    </ol>
    <h4>Ergebnis:</h4>
    <ol>
        <li>5.922018541424292e+304 an der Stelle 1460</li>
        <li>1.3069892237633987e+308 an der Stelle 1476</li>
    </ol>
    <button onclick="runFibonacci()"><i class="fa-solid fa-play"></i> Run!</button>
    (Output in der Konsole)
    <br><br>
    <button onclick="toggleCode('task3-code')"><i class="fa-solid fa-code"></i> Source Code</button>
    <br>
    <pre id="task3-code" class="code-block">
        <code>function fibonacci(n) {
    if (n === 0) {
        return [];
    } else if (n === 1) {
        return [0n];
    } else {
        let fib = [0n, 1n];
        for (let i = 2; i < n; i++) {
            fib.push(fib[i - 1] + fib[i - 2]);
        }
        return fib;
    }
}</code></pre>
</div>
<hr>

<h2 id="task4">4.4 TopSort</h2>

<div class="container">
    <p style="margin-top: 0">In jedem Projekt fallen Aufgaben (Tasks) an. Zwischen den Aufgaben gibt es paarweise
        Abhängigkeiten. Z.B. kann Task2 von Task1 abhängen, d.h. erst muss Task1 fertig sein, bevor Task2 starten kann,
        weil es dessen Ergebnisse benötigt. Tasks können auch unabhängig voneinander sein und parallel ablaufen. In
        JavaScript können Sie die Abhängigkeiten in Arrays codieren, z.B. kann man bei <code>[["schlafen","studieren"],["essen","studieren"],["studieren","prüfen"]]</code>
        nicht prüfen, ohne vorher gegessen zu haben. Transitive Abhängigkeiten müssen also berücksichtigt werden.</p>
    <p>Schreiben Sie in JavaScript eine Funktion <code>topsort()</code>, die eine <a
            href="https://de.wikipedia.org/wiki/Topologische_Sortierung" target="_blank">topologische Sortierung</a>
        berechnet. Topologische Sortierung ist eine Form von Sortierung. Sie kennen die Funktion <code>Array.prototype.sort()</code>
        und wissen, was als
        Ergebnis erwartet wird, nämlich eine sortiere Liste. Genauso ist das hier. Die Funktion <code>topsort()</code>
        soll eine
        sortierte Liste ausgeben, die keine der eingegebenen Abhängigkeiten verletzt.</p>
    <p>Achten Sie auf Performanz. Berechnen Sie die topologische Sortierung in <a
            href="https://de.wikipedia.org/wiki/Topologische_Sortierung#Gesamtverhalten" target="_blank">linearer
        Zeit</a> (Average
        Case). Testen Sie Ihren Code und verwenden Sie für Ihre Tests <a
                href="https://developer.mozilla.org/de/docs/Web/API/Console/assert" target="_blank">console.assert</a>.
    </p>
    <br>
    <button onclick="testTopSort()"><i class="fa-solid fa-play"></i> Test</button>
    (Output in der Konsole)
    <br><br>
    <button onclick="toggleCode('task4-code')"><i class="fa-solid fa-code"></i> Source Code</button>
    <br>
    <pre id="task4-code" class="code-block">
        <code>function compare(a, b) {
    if (a[0] === b[1]) {
        return 1;
    } else if (a[1] === b[0]) {
        return -1;
    } else {
        return 0;
    }
}

function topSort(input) {
    let array = input;
    array.sort(compare);
    const sorted = new Set;
    for (let x in array) {
        sorted.add(array[x][0]);
        if (x == array.length - 1) {
            sorted.add(array[x][1]);
        }
    }
    return sorted;
}

function testTopSort() {
    const array = [["schlafen", "studieren"], ["essen", "studieren"], ["studieren", "prüfen"]];
    console.log(`Input:`);
    console.log(array);
    const sorted = topSort(array);
    console.log(`Output:`);
    console.log(sorted);
    console.assert(Array.from(sorted).toString() === "schlafen,essen,studieren,prüfen");
}</code></pre>
</div>

<a id="top_button" href="#top"><i class="fa-solid fa-arrow-up"></i></a>
</body>
</html>